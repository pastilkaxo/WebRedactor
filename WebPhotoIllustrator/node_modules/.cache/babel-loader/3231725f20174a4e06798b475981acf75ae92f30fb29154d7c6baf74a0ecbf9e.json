{"ast":null,"code":"import { fabric } from \"fabric\";\n\n// --- ARRANGE / MOVE ---\nexport function enableArrange(canvas) {\n  canvas.isDrawingMode = false;\n  canvas.selection = true;\n  canvas.forEachObject(obj => obj.selectable = true);\n}\n\n// --- SELECTION ---\nexport function enableSelection(canvas) {\n  canvas.isDrawingMode = false;\n  canvas.selection = true;\n  canvas.forEachObject(obj => obj.selectable = true);\n}\n\n// --- CROP ---\nexport function enableCrop(canvas) {\n  canvas.isDrawingMode = false;\n  canvas.selection = false;\n  // Можно добавить прямоугольник маски для обрезки\n  // Возвращает функцию, чтобы обрезать выбранный объект\n  return function cropSelected() {\n    const active = canvas.getActiveObject();\n    if (!active) return;\n    active.clone(cloned => {\n      canvas.remove(active);\n      canvas.add(cloned);\n      cloned.clipPath = new fabric.Rect({\n        left: 0,\n        top: 0,\n        width: cloned.width,\n        height: cloned.height\n      });\n    });\n  };\n}\n\n// --- FIGURES ---\nexport function addFigure(canvas, type = \"rect\", options = {}) {\n  let shape;\n  switch (type) {\n    case \"rect\":\n      shape = new fabric.Rect({\n        width: 100,\n        height: 100,\n        fill: \"red\",\n        ...options\n      });\n      break;\n    case \"circle\":\n      shape = new fabric.Circle({\n        radius: 50,\n        fill: \"blue\",\n        ...options\n      });\n      break;\n    case \"triangle\":\n      shape = new fabric.Triangle({\n        width: 100,\n        height: 100,\n        fill: \"green\",\n        ...options\n      });\n      break;\n    default:\n      return;\n  }\n  canvas.add(shape);\n  canvas.setActiveObject(shape);\n}\n\n// --- ERASER ---\nexport function enableEraser(canvas) {\n  canvas.isDrawingMode = false;\n  canvas.selection = false;\n  const eraser = new fabric.EraserBrush(canvas);\n  canvas.freeDrawingBrush = eraser;\n  canvas.isDrawingMode = true;\n}\n\n// --- CUT ---\nexport function cutSelected(canvas) {\n  const active = canvas.getActiveObject();\n  if (!active) return;\n  canvas.remove(active);\n}\n\n// --- FILL ---\nexport function fillSelected(canvas, color = \"red\") {\n  const active = canvas.getActiveObject();\n  if (!active) return;\n  if (\"fill\" in active) active.set({\n    fill: color\n  });\n  canvas.renderAll();\n}\n\n// --- GRADIENT ---\nexport function applyGradient(canvas, active, colors = [\"red\", \"blue\"]) {\n  if (!active) return;\n  active.set(\"fill\", new fabric.Gradient({\n    type: 'linear',\n    gradientUnits: 'pixels',\n    coords: {\n      x1: 0,\n      y1: 0,\n      x2: active.width,\n      y2: active.height\n    },\n    colorStops: colors.map((c, i) => ({\n      offset: i / (colors.length - 1),\n      color: c\n    }))\n  }));\n  canvas.renderAll();\n}\n\n// --- ZOOM ---\nexport function enableZoom(canvas) {\n  canvas.isDrawingMode = false;\n  canvas.selection = false;\n  // Реализация через события wheel уже есть в EditorContent\n}\n\n// --- PICKER ---\nexport function pickColor(canvas, pointer, callback) {\n  const objects = canvas.getObjects();\n  for (let i = objects.length - 1; i >= 0; i--) {\n    const obj = objects[i];\n    if (obj.containsPoint(pointer)) {\n      callback(obj.fill || \"#000000\");\n      break;\n    }\n  }\n}\n\n// --- TEXT ---\nexport function addText(canvas, text = \"Text\") {\n  const t = new fabric.Textbox(text, {\n    left: 100,\n    top: 100,\n    fontSize: 20\n  });\n  canvas.add(t);\n  canvas.setActiveObject(t);\n}\n\n// --- PENCIL ---\nexport function enablePencil(canvas, color = \"black\", width = 2) {\n  canvas.isDrawingMode = true;\n  canvas.freeDrawingBrush.color = color;\n  canvas.freeDrawingBrush.width = width;\n}\n\n// --- HAND / PAN ---\nexport function enableHand(canvas) {\n  canvas.isDrawingMode = false;\n  canvas.selection = false;\n  // Пан через mouse:down, mouse:move уже реализован в EditorContent\n}\n\n// --- LASSO ---\nexport function enableLasso(canvas) {\n  canvas.isDrawingMode = false;\n  canvas.selection = true;\n  // Можно использовать polygon selection (доп. реализация)\n}","map":{"version":3,"names":["fabric","enableArrange","canvas","isDrawingMode","selection","forEachObject","obj","selectable","enableSelection","enableCrop","cropSelected","active","getActiveObject","clone","cloned","remove","add","clipPath","Rect","left","top","width","height","addFigure","type","options","shape","fill","Circle","radius","Triangle","setActiveObject","enableEraser","eraser","EraserBrush","freeDrawingBrush","cutSelected","fillSelected","color","set","renderAll","applyGradient","colors","Gradient","gradientUnits","coords","x1","y1","x2","y2","colorStops","map","c","i","offset","length","enableZoom","pickColor","pointer","callback","objects","getObjects","containsPoint","addText","text","t","Textbox","fontSize","enablePencil","enableHand","enableLasso"],"sources":["C:/Users/Vladislav/Desktop/WebIllustrator/WebPhotoIllustrator/src/Components/Main/Editor/FabricTools.js"],"sourcesContent":["import { fabric } from \"fabric\";\r\n\r\n// --- ARRANGE / MOVE ---\r\nexport function enableArrange(canvas) {\r\n  canvas.isDrawingMode = false;\r\n  canvas.selection = true;\r\n  canvas.forEachObject(obj => obj.selectable = true);\r\n}\r\n\r\n// --- SELECTION ---\r\nexport function enableSelection(canvas) {\r\n  canvas.isDrawingMode = false;\r\n  canvas.selection = true;\r\n  canvas.forEachObject(obj => obj.selectable = true);\r\n}\r\n\r\n// --- CROP ---\r\nexport function enableCrop(canvas) {\r\n  canvas.isDrawingMode = false;\r\n  canvas.selection = false;\r\n  // Можно добавить прямоугольник маски для обрезки\r\n  // Возвращает функцию, чтобы обрезать выбранный объект\r\n  return function cropSelected() {\r\n    const active = canvas.getActiveObject();\r\n    if (!active) return;\r\n    active.clone(cloned => {\r\n      canvas.remove(active);\r\n      canvas.add(cloned);\r\n      cloned.clipPath = new fabric.Rect({\r\n        left: 0,\r\n        top: 0,\r\n        width: cloned.width,\r\n        height: cloned.height\r\n      });\r\n    });\r\n  };\r\n}\r\n\r\n// --- FIGURES ---\r\nexport function addFigure(canvas, type = \"rect\", options = {}) {\r\n  let shape;\r\n  switch (type) {\r\n    case \"rect\":\r\n      shape = new fabric.Rect({ width: 100, height: 100, fill: \"red\", ...options });\r\n      break;\r\n    case \"circle\":\r\n      shape = new fabric.Circle({ radius: 50, fill: \"blue\", ...options });\r\n      break;\r\n    case \"triangle\":\r\n      shape = new fabric.Triangle({ width: 100, height: 100, fill: \"green\", ...options });\r\n      break;\r\n    default:\r\n      return;\r\n  }\r\n  canvas.add(shape);\r\n  canvas.setActiveObject(shape);\r\n}\r\n\r\n// --- ERASER ---\r\nexport function enableEraser(canvas) {\r\n  canvas.isDrawingMode = false;\r\n  canvas.selection = false;\r\n\r\n  const eraser = new fabric.EraserBrush(canvas);\r\n  canvas.freeDrawingBrush = eraser;\r\n  canvas.isDrawingMode = true;\r\n}\r\n\r\n// --- CUT ---\r\nexport function cutSelected(canvas) {\r\n  const active = canvas.getActiveObject();\r\n  if (!active) return;\r\n  canvas.remove(active);\r\n}\r\n\r\n// --- FILL ---\r\nexport function fillSelected(canvas, color = \"red\") {\r\n  const active = canvas.getActiveObject();\r\n  if (!active) return;\r\n  if (\"fill\" in active) active.set({ fill: color });\r\n  canvas.renderAll();\r\n}\r\n\r\n// --- GRADIENT ---\r\nexport function applyGradient(canvas, active, colors = [\"red\", \"blue\"]) {\r\n  if (!active) return;\r\n  active.set(\"fill\", new fabric.Gradient({\r\n    type: 'linear',\r\n    gradientUnits: 'pixels',\r\n    coords: { x1: 0, y1: 0, x2: active.width, y2: active.height },\r\n    colorStops: colors.map((c, i) => ({ offset: i / (colors.length - 1), color: c }))\r\n  }));\r\n  canvas.renderAll();\r\n}\r\n\r\n// --- ZOOM ---\r\nexport function enableZoom(canvas) {\r\n  canvas.isDrawingMode = false;\r\n  canvas.selection = false;\r\n  // Реализация через события wheel уже есть в EditorContent\r\n}\r\n\r\n// --- PICKER ---\r\nexport function pickColor(canvas, pointer, callback) {\r\n  const objects = canvas.getObjects();\r\n  for (let i = objects.length - 1; i >= 0; i--) {\r\n    const obj = objects[i];\r\n    if (obj.containsPoint(pointer)) {\r\n      callback(obj.fill || \"#000000\");\r\n      break;\r\n    }\r\n  }\r\n}\r\n\r\n// --- TEXT ---\r\nexport function addText(canvas, text = \"Text\") {\r\n  const t = new fabric.Textbox(text, { left: 100, top: 100, fontSize: 20 });\r\n  canvas.add(t);\r\n  canvas.setActiveObject(t);\r\n}\r\n\r\n// --- PENCIL ---\r\nexport function enablePencil(canvas, color = \"black\", width = 2) {\r\n  canvas.isDrawingMode = true;\r\n  canvas.freeDrawingBrush.color = color;\r\n  canvas.freeDrawingBrush.width = width;\r\n}\r\n\r\n// --- HAND / PAN ---\r\nexport function enableHand(canvas) {\r\n  canvas.isDrawingMode = false;\r\n  canvas.selection = false;\r\n  // Пан через mouse:down, mouse:move уже реализован в EditorContent\r\n}\r\n\r\n// --- LASSO ---\r\nexport function enableLasso(canvas) {\r\n  canvas.isDrawingMode = false;\r\n  canvas.selection = true;\r\n  // Можно использовать polygon selection (доп. реализация)\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}